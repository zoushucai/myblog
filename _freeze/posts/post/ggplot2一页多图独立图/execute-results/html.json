{
  "hash": "58af890fd4cf1b0035f42cf49ae3c038",
  "result": {
    "markdown": "---\ntitle: ggplot2一页多图(图独立)\ndate: '2018-07-15'\ncategories: r\n---\n\n\n\n\n\n在一个页面上自由组合各种图(可以毫无关联)，省空间，又能表达自己需求。\n\n::: {.cell}\n\n```{.r .cell-code}\nrequire(ggplot2)\nrequire(grid)\n#####现将图画好，并且赋值变量，储存#####\np1 <- ggplot(mtcars, aes(mpg, wt, colour = factor(cyl))) + geom_point()\np2 <- ggplot(diamonds, aes(carat, depth, colour = color)) + geom_point()\np3 <- ggplot(diamonds, aes(carat, depth, colour = color)) + geom_point() + facet_grid(.~color,scale = \"free\")\np1\n```\n\n::: {.cell-output-display}\n![](ggplot2一页多图独立图_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\np2\n```\n\n::: {.cell-output-display}\n![](ggplot2一页多图独立图_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\np3\n```\n\n::: {.cell-output-display}\n![](ggplot2一页多图独立图_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n:::\n\n\n这里有三张图`p1,p1,p3`，我想把它输出到一个页面上，不单独输出，可以用一些方法\n\n## 方法一: 使用grid包\n\n\n::: {.cell}\n\n```{.r .cell-code}\n########新建画图页面###########\ngrid.newpage()  ##新建页面\npushViewport(viewport(layout = grid.layout(2,2))) ####将页面分成2*2矩阵\nvplayout <- function(x,y){\n  viewport(layout.pos.row = x, layout.pos.col = y)\n}\nprint(p3, vp = vplayout(1,1:2))   ###将（1,1)和(1,2)的位置画图p3\nprint(p2, vp = vplayout(2,1))   ###将(2,1)的位置画图p2\nprint(p1, vp = vplayout(2,2))  ###将（2,2)的位置画图p1\n```\n\n::: {.cell-output-display}\n![](ggplot2一页多图独立图_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#dev.off() ##画下一幅图，记得关闭窗口\n```\n:::\n\n\n## 方法二: 使用patchwork包\n这个包需要从github上安装\n```\ndevtools::install_github(\"thomasp85/patchwork\")\n```\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(patchwork)\np1 <- ggplot(mtcars, aes(mpg, wt, colour = factor(cyl))) + geom_point()\np2 <- ggplot(diamonds, aes(carat, depth, colour = color)) + geom_point()\np1 + p2 #把图p1 ,p2画在一页上\n```\n\n::: {.cell-output-display}\n![](ggplot2一页多图独立图_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# 可以直接进行拼凑\nggplot(mtcars, aes(mpg, wt, colour = factor(cyl))) + geom_point() + \n  ggplot(diamonds, aes(carat, depth, colour = color)) + geom_point()# 默认的页面布局是1行多列\n```\n\n::: {.cell-output-display}\n![](ggplot2一页多图独立图_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n###  使用`plot_layout()`函数调整页面布局\n\n::: {.cell}\n\n```{.r .cell-code}\np1 + p2 + plot_layout(ncol = 1, heights = c(3, 1))\n```\n\n::: {.cell-output-display}\n![](ggplot2一页多图独立图_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n### 图表之间添加或删除空格--`plot_spacer()`\n\n::: {.cell}\n\n```{.r .cell-code}\np1 + plot_spacer() + p2\n```\n\n::: {.cell-output-display}\n![](ggplot2一页多图独立图_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n拼凑提供的一个非常有用的功能是它使用户能够创建“子图”\n\n::: {.cell}\n\n```{.r .cell-code}\np3 <- ggplot(mtcars) + geom_smooth(aes(disp, qsec), method = 'loess',formula= y ~ x)\np4 <- ggplot(mtcars) + geom_bar(aes(carb))\n\np4 + {\n    p1 + {\n        p2 +p3 +plot_layout(ncol = 1)\n      }\n  } +plot_layout(ncol = 1)\n```\n\n::: {.cell-output-display}\n![](ggplot2一页多图独立图_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n### 高级功能\n拼凑的有趣之处在于您可以使用`+`,`-`运算符来定义嵌套级别：\n\n::: {.cell}\n\n```{.r .cell-code}\np1 + p2 + p3 + plot_layout(ncol = 1)\n```\n\n::: {.cell-output-display}\n![](ggplot2一页多图独立图_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n\n# 看看下面的代码并注意到现在p1和p2是“嵌套的”：\np1 + p2 - p3 + plot_layout(ncol = 1)\n```\n\n::: {.cell-output-display}\n![](ggplot2一页多图独立图_files/figure-html/unnamed-chunk-8-2.png){width=672}\n:::\n\n```{.r .cell-code}\n\n\n## 接下来两个操作是|和/分别用于水平和垂直布局。您可以在同一操作中使用它们\n(p1 | p2 | p3) /p4\n```\n\n::: {.cell-output-display}\n![](ggplot2一页多图独立图_files/figure-html/unnamed-chunk-8-3.png){width=672}\n:::\n:::\n\n最后，您可以使用`＆`或`*`而不必为每个单独的绘图设置布局设置。这是非常有用的功能，特别是如果您需要将多个图组合在一起。 `*`修改当前嵌套级别的图：\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(p1 + (p2 + p3) + p4 + plot_layout(ncol = 1)) * theme_bw() # * 只会影响当前嵌套级别的图\n```\n\n::: {.cell-output-display}\n![](ggplot2一页多图独立图_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\np1 + (p2 + p3) + p4 + plot_layout(ncol = 1) & theme_bw() # & 将递归到嵌套级别\n```\n\n::: {.cell-output-display}\n![](ggplot2一页多图独立图_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n#> R version 4.2.1 (2022-06-23)\n#> Platform: aarch64-apple-darwin20 (64-bit)\n#> Running under: macOS Monterey 12.5.1\n#> \n#> Matrix products: default\n#> BLAS:   /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRblas.0.dylib\n#> LAPACK: /Library/Frameworks/R.framework/Versions/4.2-arm64/Resources/lib/libRlapack.dylib\n#> \n#> locale:\n#> [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8\n#> \n#> attached base packages:\n#> [1] grid      stats     graphics  grDevices utils     datasets  methods  \n#> [8] base     \n#> \n#> other attached packages:\n#> [1] patchwork_1.1.2 ggplot2_3.3.6  \n#> \n#> loaded via a namespace (and not attached):\n#>  [1] pillar_1.8.1      compiler_4.2.1    tools_4.2.1       digest_0.6.29    \n#>  [5] lattice_0.20-45   nlme_3.1-159      viridisLite_0.4.1 jsonlite_1.8.0   \n#>  [9] evaluate_0.16     lifecycle_1.0.1   tibble_3.1.8      gtable_0.3.0     \n#> [13] mgcv_1.8-40       pkgconfig_2.0.3   rlang_1.0.4       Matrix_1.4-1     \n#> [17] cli_3.3.0         DBI_1.1.3         rstudioapi_0.14   yaml_2.3.5       \n#> [21] xfun_0.32         fastmap_1.1.0     withr_2.5.0       stringr_1.4.1    \n#> [25] dplyr_1.0.9       knitr_1.40        generics_0.1.3    htmlwidgets_1.5.4\n#> [29] vctrs_0.4.1       tidyselect_1.1.2  glue_1.6.2        R6_2.5.1         \n#> [33] fansi_1.0.3       rmarkdown_2.16.1  farver_2.1.1      purrr_0.3.4      \n#> [37] magrittr_2.0.3    splines_4.2.1     scales_1.2.1      htmltools_0.5.3  \n#> [41] assertthat_0.2.1  colorspace_2.0-3  labeling_0.4.2    utf8_1.2.2       \n#> [45] stringi_1.7.8     munsell_0.5.0\n```\n:::\n",
    "supporting": [
      "ggplot2一页多图独立图_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}